<div class="container result-validation">
  <h1>Validation results</h1>

  <div class="content-block">

    <p>
      Your personal workspace is here:     
      <br>
      <a [routerLink]="['/validate', uploadId]">{{environmentUrl}}/iati-feedback/validate/{{uploadId}}</a>
      <button class="btn btn-outline-primary ml-2" (click)="copyTextToClipboard('text')">Copy the address</button>
    </p>
    <p>This is where you can view your Validation Reports. You can add more files using the button at the bottom of the page. You can also copy the address of your personal workplace and access the results later, which can be useful if you are processing a large amount of data and it is taking some time to complete.</p>
    <p></p>
  </div>

  <div *ngIf="iatiDatasetDatas.length" class="files">
    <div class="row heading">
      <div class="col-12 col-md">
        File name
      </div>
      <div class="col-12 col-md d-none d-md-block">
        Uploaded
      </div>
      <div class="col-12 col-md d-none d-md-block">
        Validated
      </div>
    </div>

    <ng-container *ngFor="let iatiDatasetData of iatiDatasetDatas">
      <div class="wrapper">
        <div class="row {{ iatiDatasetData.class }}" (click)="rowClick(iatiDatasetData)">
          <div class="col-12 col-md">
            {{ iatiDatasetData.filename }}
          </div>
          <div class="col-12 col-md">
            <app-spinner *ngIf="iatiDatasetData.class === 'normal'" [backColor]="'darkslategray'"></app-spinner>
            {{ iatiDatasetData.created | date:'yyyy-MM-dd HH:mm (z)' }}
          </div>
          <div class="col-12 col-md">
            <app-spinner *ngIf="iatiDatasetData.class === 'normal'" [backColor]="'darkslategray'"></app-spinner>
            {{ iatiDatasetData.validated | date:'yyyy-MM-dd HH:mm (z)' }}
          </div>
          <div class="col-12 d-md-none"><hr></div>
        </div>
      </div>
    </ng-container>
  </div>

  <div class="content-block">
    <button
      class="btn btn-success iati-button "
      (click)="addMoreFiles()"
    >
      Add more files
    </button>
  </div>

  <div class="content-block">
    

      <!--
     <p>You can choose the option below for the validator to send you a notification via email once all the validation reports are ready.
    </p>
    <ng-container *ngIf="emailMode === 'draft'">
      <p>
        <b style="color:red">DEV NOTE Emails not yet implemented - UAT to decide if required.</b> Enter your email below. Your email will not be shared with anyone and will be removed when your personal workspace is deleted.
      </p>
      <div class="row">
        <form class="email-form" [formGroup]="form" (submit)="saveEmailAddress()">
          <input
            type="email"
            [formControl]="email"
            class="urls-input"
            placeholder="your email address"
          />
          <button
            class="btn btn-success iati-button "
            type="submit"
            [disabled]="form.invalid"
          >
            Add email address
          </button>
        </form>
      </div>
    </ng-container>

    <ng-container *ngIf="emailMode === 'saved'">
      <p>
        Send a notification to this address:
      </p>
        <span class="saved-email">{{email.value}}</span>
        <button
          class="btn btn-success iati-button "
          (click)="editEmail()"
        >
          Edit email address
        </button>
    </ng-container>

    <ng-container *ngIf="emailMode === 'edit'">
      <p>
        Enter your email address to receive a notification
      </p>
        <form class="email-form" [formGroup]="newForm" (submit)="updateEmail()">
          <input
            type="email"
            [formControl]="newEmail"
            class="urls-input"
            placeholder="your email address"
          />
          <button
            class="btn btn-success iati-button "
            type="submit"
            [disabled]="newForm.invalid || !newForm.touched"
          >
            Save
          </button>
          <button
            class="btn btn-success iati-button "
            (click)="returnViewMode()"
          >
            Cancel
          </button>
        </form>
        <button
          class="btn btn-success iati-button "
          (click)="removeEmail()"
        >
          Remove
        </button>
    </ng-container>
    -->
  </div>
</div>
